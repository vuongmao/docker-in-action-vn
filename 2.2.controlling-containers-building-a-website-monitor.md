# Kiểm soát comtainers: Xây dựng một website monitor

Hầu hết các ví dụ trong quyển sách này sẽ sử dụng phần mềm thật sự. Các ví dụ thực tế sẽ giúp giới thiệu các tính năng của DOCKER và minh họa việc sử dụng nó như thế nào trong các hoạt động hằng ngày. Trong ví dụ đầu tiên, **BẠN SẼ CÀI ĐẶT MỘT WEB SERVER NGIX**. Web servers là những chương trình giúp cho các files website và các chương trình có thể được truy cập thông qua web browser qua network. Bạn sẽ không xây dựng một website, nhưng bạn cài đặt để khởi động một web server với DOCKER. Nếu bạn theo những hướng dẫn trong ví dụ này, web server chỉ có thể khả dụng cho những những chương trình trên máy tính của bạn.

Giả sử một khách hàng mới đi dạo trong văn phòng của bạn và cho bạn một lời đề nghị thái quá để xây dựng cho họ một website mới. Họ muốn website có được sự theo dõi chặt chẽ. Vị khách đặc biệt này muốn chạy trên hệ điều hành của họ. và, họ muốn bạn cung cấp một giải pháp qua email cho team của họ khi server downn. Họ cũng đã nghe về những phần mềm web server phổ biến là NGINX và có yêu cầu bạn sử dụng nó. Đã đọc về giá trị làm việc với DOCKER, bạn đã có quyết định sử dụng nó cho dự án này. Hình 2.1 trình bày kế hoạch kiến trúc của bạn cho dự án này.

![](https://github.com/vuongmao/docker-in-action-vn/blob/master/asset/2.2-image-1.png)

Hình 2.1 Ba container để bạn xây dựng trong ví dụ này

ĐÂY LÀ VÍ DỤ SỬ DỤNG 3 CONTAINERS. **Containers đầu tiên** sẽ chạy NGINX; **container thứ hai** sẽ chạy một chương trình gọi là 'mailer'. Cả hai containers này sẽ chạy như những containers detached. Detached nghĩa là container sẽ chạy ở background, mà không được gắn bất cứ thông tin input hay output vào stream. **Một container thứ ba** gọi là 'agent', nó sẽ chay trong một container tương tác. Cả container mailer và agent là những đoạn scrips nhỏ được tạo ra cho ví dụ này. Trong phần này bạn sẽ học về những thứ sau làm việc như thế nào:

■ Tạo detached và interative containers

■ Liệt kễ những container trên hệ thống của bạn

■ Xem logs container

■ Stop và restart containers

■ Lặp lại một terminal đến một container

■ Detach from an attached container

■ Detach từ một container được đính kèm.

Không để chờ đợi lâu hơn nữa, nào hãy bắt đầu làm nhưng order của khách hàng.

## 2.2.1 Creating and starting một container mới

Khi cài đặt phần mềm với DOCKER, chúng ta nói rằng chúng ta cài đặt một IMAGE. Có nhiều cách khác nhau để cài một IMAGE và nhiều source cho những IMAGE. IMAGE được đề cập sâu hơn trong chương 3. Trong ví dụ này, chúng ta sẽ download và cài đặt một IMAGE cho NGINX từ DOCKER Hub. Hãy nhớ rằng, DOCKER Hub là một nơi đăng ký công cộng được cung cấp bởi DOCKER Inc. IMAGE NGINX từ DOCKER Inc gọi là một repository đáng tin cậy. Thông thường, người hay tổ chức xuất bản những phần kiểm soát các repositories đáng tin cậy cho phần mềm đó. Chạy command dưới đây để download, install và start một container chạy NGINX:

```
docker run --detach \                           <- NOTE the detach flag
    --name web nginx:latest
```

Khi bạn chạy command này, DOCKER sẽ install `nginx:latest` từ repository NGINX được lưu trữ trên DOCKER Hub (Được đề cập trong chương 3) và chạy phần mềm. Sau khi DOCKER đã install và start running NGINX, một dòng ký tự ngẫu nhiên giống như vầy sẽ được xuất ra trên terminal. Nó sẽ trông giống như thế này:

```
7cb5d2b9a7eab87f07182b5bf58936c9947890995b1b94f412912fa822a9ecb5
```

**Đoạn ký tự đó là định danh duy nhất của container** đó là cái đã được tạo ra để chạy NGINX. Mỗi lần bạn chạy `docker run` và tạo ra một container mới, container đó sẽ có định danh duy nhất giống như thế. Nó phổ biến cho người dùng để nắm bắt đầu ra này với một biến để sử dụng với những command khác. Bạn không cần phải làm thế cho mục địch của ví dụ này. Sau khi định danh đã được hiển thị, nó dường như có lẽ không giốn với mọi thứ đã xảy ra. Đó là bởi vì bạn đã sử dụng lựa chọn `--detach` và bắt đầu chương trình ở background. Điều này có nghĩa là chương trình đã started nhưng nó không thêm vào trên terminal của bạn. Điều này thật có nghĩa khi bắt đầu start NGINX với cách này bởi vì chúng ta sẽ chạy một phài chương trình khác.

Chạy container detached là sự phù hợp tuyệt vời cho các chương trình để nó nằm im trong background. Kiểu chương trình này được gọi là daemon. Một daemon thường tương tác với những chương trình khác hay người thông qua network hay nhưng công cụ giao tiếp khác. Khi bạn chạy daemon hay chương trình khác trong containe, cái bạn muốn chạy ở background, hãy nhớ sử dụng `--detach` flag hay ở dạng rút gọn của nó `-d`

Another daemon that your client needs is a mailer. A mailer waits for connections from a caller and then sends an email. The following command will install and run a mailer that will work for this example:

Chương trình daemon khác mà khách hàng của bạn cần là một 'mailer'. Một 'mailer' chờ đợi kết nối từ một cuộc gọi sau đó gửi email. Command dưới đây sẽ install và run một mailer để làm việc trong ví dụ này:

```
docker run -d \           <- Start detached
    --name mailer \
```

Command này sử dụng dạng rút gọn của cờ `detach` để bắt đầu môt container mới tên là 'mailer' chạy ở background. Tại thời điểm này bạn đã chạy 2 command và đã giao 2 trong 3 thứ của hệ thống cái mà khác hàng bạn muốn nó. Thành phần cuối cùng, gọi là 'agent', nó là sự phù hợp tuyệt vời cho sự tương tác với container.
